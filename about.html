<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>About – KjugeBloc</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400;1,500&family=Libre+Baskerville:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="images/logo/tab_icon.png" type="image/png" />
</head>
<body class="about-page">

  <header class="site-header">
    <div class="header-content">
      <div class="site-branding">
        <a href="index.html">
          <img src="images/logo/front-icon_rocks.png" alt="KjugeBloc logo" class="logo">
        </a>
        <h1>KjugeBloc</h1>
      </div>
      <nav>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html" class="active">About</a></li>
          <li><a href="access.html">Access</a></li>
          <li><a href="area-index.html">Area Index</a></li>
          <li><a href="map.html">Map</a></li>
          <li><a href="store.html">Store</a></li>
          <li style="padding-right: 10px;">
            <a href="#">
              <img src="images/logo/search-icon.png" alt="Search" style="height: 18px; vertical-align: middle;">
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </header>

  <main>

    <section class="about-row">
      <div class="about-left" id="intro-text"></div>
      <div class="about-right">
        <div class="image-wrapper">
          <img src="images/photos/about-photo_imperator.jpg" alt="Imperator photo">
        </div>
      </div>
    </section>

    <section class="about-row reverse">
      <div class="about-left" id="ethics-text"></div>
      <div class="about-right">
        <div class="image-wrapper">
          <img src="images/photos/about-photo_toledo.jpg" alt="Lätt Fjäder photo">
        </div>
      </div>
    </section>

    <section class="about-row">
      <div class="about-right" id="problems-text_1"></div>
      <div class="about-left">
        <div class="image-wrapper">
          <img src="images/photos/about-photo_latt-fjader.jpg" alt="Toledo photo">
        </div>
      </div>
    </section>

    <section class="about-row reverse">
      <div class="about-right" id="problems-text_2"></div>
      <div class="about-left">
        <div class="image-wrapper">
          <img src="images/photos/about-photo_alla-himmelen.jpg" alt="Alla Himmelen photo">
        </div>
      </div>
    </section>

    <section class="about-row">
      <div class="about-right" id="problems-text_3"></div>
      <div class="about-left">
        <div class="image-wrapper">
          <img src="images/photos/about-photo_regretto.jpg" alt="Regretto photo">
        </div>
      </div>
    </section>

    <div style="margin-top: 100px;"></div>

    <section id="video-section" class="about-row reverse" style="display: none;">
      <div class="about-right" id="links"></div>
      <div class="about-left">
        <div class="image-wrapper">
          <iframe 
            width="100%" 
            height="315" 
            src="https://www.youtube.com/embed/FgarKjYpa74?rel=0" 
            title="Alla Himmelen – KjugeBloc" 
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
            allowfullscreen>
          </iframe>
        </div>
      </div>
    </section>

    <div style="display: flex; justify-content: center; margin-top: 0px; margin-bottom: -30px;">
      <div style="position: relative; display: inline-block;">
        <img 
          src="images/logo/ghost.png" 
          alt="Reveal Video" 
          style="width: 300px; height: auto; pointer-events: none;" 
        />
        <div 
          onclick="document.getElementById('video-section').style.display='flex'; document.getElementById('video-section').scrollIntoView({ behavior: 'smooth' });"
          style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: default;"
        ></div>
      </div>
    </div>

  </main>

  <footer>
    <p>© 2025 KjugeBloc</p>
  </footer>

  <script>
    function renderFormattedText(filePath, targetId) {
      fetch(filePath)
        .then(res => res.ok ? res.text() : Promise.reject('Content not found.'))
        .then(text => {
          const container = document.getElementById(targetId);
          const lines = text.split('\n');
          let html = '';
          let inArrowList = false;

          lines.forEach(line => {
            line = line.trim();
            if (!line) {
              html += '<br>';
              return;
            }

            line = line.replace(/'''(.*?)'''/g, (_, match) =>
              `<span style="font-family: 'Libre Baskerville', serif; font-style: italic; color: #aaa;">${match}</span>`
            );

            if (!line.startsWith('»') && inArrowList) {
              html += '</ul>';
              inArrowList = false;
            }

            if (line.match(/^\{(.+)\}$/)) {
              const heading = line.match(/^\{(.+)\}$/)[1].trim();
              html += `<h1>${heading}</h1>`;

            } else if (line.match(/^\(\((.+)\)\)$/)) {
              const subheading = line.match(/^\(\((.+)\)\)$/)[1].trim();
              html += `<h3>${subheading}</h3>`;

            } else if (line.startsWith('»')) {
              if (!inArrowList) {
                html += '<ul class="arrow-list">';
                inArrowList = true;
              }

              const itemText = line.replace(/^»\s*/, '');
              const linkedText = itemText.replace(/\[(.+?)\]\((.+?)\)/g, '<a href="$2">$1</a>');
              html += `<li class="arrow-item">${linkedText}</li>`;

            } else if (line.startsWith('•')) {
              html += `<div class="tight-bullet">${line}</div>`;

            } else {
              html += `<p>${line}</p>`;
            }
          });

          if (inArrowList) html += '</ul>';
          container.innerHTML = html;
        })
        .catch(() => {
          const container = document.getElementById(targetId);
          container.textContent = 'Failed to load content.';
        });
    }

    document.addEventListener("DOMContentLoaded", () => {
      renderFormattedText('text/about_intro.txt', 'intro-text');
      renderFormattedText('text/about_ethics.txt', 'ethics-text');
      renderFormattedText('text/about_problems_1.txt', 'problems-text_1');
      renderFormattedText('text/about_problems_2.txt', 'problems-text_2');
      renderFormattedText('text/about_problems_3.txt', 'problems-text_3');
      renderFormattedText('text/links.txt', 'links');
    });
  </script>

</body>
</html>
